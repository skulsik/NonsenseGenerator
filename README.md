# NonsenseGenerator
___

## Описание проекта
Данный проект предназначен для демонстрации навыков в программировании на **PHP**, верстке на **bootstrap** и разработки приложения с использованием фреймворка **Laravel**. В проекте согласно техническому заданию реализован механизм позволяющий генерировать кастомный текст из предложений, которые в свою очередь рандомно извлекаются из текстов записанных в бд. Пользователям доступно: регистрация, авторизация, а также создание, редактирование, просмотр и удаление текстов из которых генерируется уникальный текст, сообственно сам метод генерации текста. В качестве программного стека использовались: язык программирования PHP - 8.1, фреймворк Laravel - 10.1, база данных MySQL - 8, BootStrap 5.

___

## Функционал проекта
Создано преложение в котором посредством встроенных методов (*модуль Auth*), пользователь имеет возможность зарегистрироваться на сайте, авторизоваться и деавторизоваться. Так же, пользователь может сгенерировать текст без авторизации, выбрав количество предложений, по умолчанию количество предложений равно 5. Зарегестрированным пользователям доступно добавление, редактирование, просмотр и удаление текста.
> ### Функции
- [x] Регистрация
- [x] Авторизация
- [x] Деавторизация
- [x] Валидация формы создания текста
- [x] Создание текста
- [x] Чтение списка текстов
- [x] Просмотр одного текста
- [x] Удаление текста
- [x] Обновление текста
- [x] Генерация кастомного текста с выбором количества предложений

___

## Установка и настройка проекта
+ Клонировать проект ```git@github.com:skulsik/NonsenseGenerator.git```
+ переход в рабочую папку, выполните команду в терминале: cd app
+ установка зависимостей, выполните команду в терминале: composer install
+ в папке app создайте фаил .env и скопируйте туда все содержимое файла .env.example
+ генерация ключа проекта, выполните команду в терминале: php artisan key:generate
+ создайте базу данных(через консоль или через программы с интерфейсом) с названием nonsense_generator, либо придумайте свое
+ в файле .env в настройках DB укажите: назавание базы данных, если вы создали бд под своим названием; имя пользователя и пароль
+ сделайте миграции, выполните команду в терминале: php artisan migrate
+ запустите проект и наслаждайтесь тестами, выполните команду в терминале: php artisan serve

___

## Методы, функции, модели
### Модель TextModel
```php
    $table->id();
    $table->string('title', 50);
    $table->string('slug', 50);
    $table->text('text');
    $table->boolean('active')->default(1);
    $table->integer('user_id')->unsigned();
    $table->foreign('user_id')->references('id')->on('users');
    $table->timestamps();
```
В модели используются поля:
- title - описание
- slug - по функционалу легкая версия slug, пробелы заменяются на "_", это нужно для определения индификаторов и ссылок на них
- text - текст донор для генератора кастомного текста
- boolean - функционал не реализован, нужен для выбора текста который будет использоваться в генерации
- user_id - ссылка на внешний ключ пользователя, владелец текста

### Контроллеры
Бизнес-логика вынесена в сервисный слой.

- class GeneratorText

### Класс GeneratorText, в сервисном слое
```php
class GeneratorText
{
    public function __construct($num_sentences)
    {
        $this->list_text = TextModel::all();
        $this->count_text_obj = TextModel::count();
        $this->num_sentences = $num_sentences;

        // Формирует один большой массив из предложений, изначально разбив каждый текст на предложения
        $list_text_modified = [];
        foreach ($this->list_text as $text)
        {
            // Разбивает текст на предложения
            $text_modified = preg_split('/(?<=[.?!])\s+(?=[а-я])/i', $text->text);
            // Собирает массив из предложений
            $list_text_modified = array_merge($list_text_modified, $text_modified);
        }

        $this->list_text_modified = $list_text_modified;
        // Количество предложений всего
        $this->count_sentences = count($list_text_modified);
    }

    public function generation_text()
    {
        $new_text = '';
        // Количество предложений, который ввел пользователь
        while($this->num_sentences > 0)
        {
            // Рандомно выбирается предложение и приклеивается к тексту
            $new_text .= ' '.$this->list_text_modified[rand(0, $this->count_sentences-1)];
            $this->num_sentences--;
        }
        return $new_text;
    }

    public function get_count_text()
    {
        return $this->count_text_obj;
    }
}
```

#### Работа класса
- На входе количество предложений "$num_sentences" из которых генерируется текст.
- Конструктор:
  - Берет из бд все тексты, считает количество (количество нужно по условию тз, должно быть >= 2)
  - С помощью цикла расбивает текст на предложения, так происходит с каждым текстом, после формирует один массив из предложений
  - В полученном массиве считает общее количество предложений
- Метод get_count_text, возвращает количество текстов, далее в отображении обрабатывается (если меньше двух, то предлагает добавить текст)
- Метод generation_text, запускается цикл с количеством итераций равным количеству предложений(которые мы должны получить в кастомном тексте), далее рандомно выбирается индекс в пределах от 0 до количества предложений, после чего по индексу берется предложение из массива присваивается строке. Возвращает кастомный текст.
